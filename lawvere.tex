% Enriched Lawvere Theories for Operational Semantics
% John C. Baez and Christian Williams
% 2019/3/4 - reverting to this version as of 2019/4/6

\documentclass{amsart}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bussproofs}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{authblk}
\usepackage{pict2e}
\usepackage[mathscr]{euscript}
\usepackage{tikz-cd}
\tikzstyle{none}=[inner sep=0pt]
\tikzstyle{circ}=[circle,fill=black,draw,inner sep=3pt]
\usepackage{fancybox}
\usepackage[all,2cell]{xy} \UseAllTwocells
\usetikzlibrary{arrows, positioning, intersections}
\input{coya-tikz.tex}
\tikzset{%
	symbol/.style={%
		draw=none,
		every to/.append style={%
			edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
	}
}

% hyperlinks
\usepackage{color}
\definecolor{myurlcolor}{rgb}{0.5,0,0}
\definecolor{mycitecolor}{rgb}{0,0,1}
\definecolor{myrefcolor}{rgb}{0,0,1}
\usepackage[pagebackref]{hyperref}
\hypersetup{colorlinks,
linkcolor=myrefcolor,
citecolor=mycitecolor,
urlcolor=myurlcolor}

\newcommand{\define}[1]{{\bf \boldmath{#1}}}
\renewcommand*{\backref}[1]{(Referred to on page #1.)}

% theorems

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{example}[theorem]{Example}
\newtheorem{corollary}{Corollary}[theorem]

\def\rd{\rotatebox[origin=c]{90}{$\dashv$}} %rotate dash right
\def\ld{\rotatebox[origin=c]{-90}{$\dashv$}} %rotate dash left

% categories

\newcommand{\Th}{\mathsf{Th}}
\newcommand{\Gph}{\mathsf{Gph}}
\newcommand{\Set}{\mathsf{Set}}
\newcommand{\Grp}{\mathsf{Grp}}
\newcommand{\Cat}{\mathsf{Cat}}
\newcommand{\Law}{\mathsf{Law}}
\newcommand{\Mnd}{\mathrm{Mnd}}
\newcommand{\Top}{\mathsf{Top}}
\newcommand{\Mon}{\mathsf{Mon}}
\newcommand{\Alg}{\mathsf{Alg}}
\newcommand{\CCC}{\mathsf{CCC}}
\newcommand{\Pos}{\mathsf{Pos}}
\newcommand{\Mod}{\mathsf{Mod}}
\newcommand{\FinSet}{\mathsf{FinSet}}
\newcommand{\NN}{\mathsf{N}}
\newcommand{\V}{\mathsf{V}}
\newcommand{\W}{\mathsf{W}}
\newcommand{\D}{\mathsf{D}}
\newcommand{\C}{\mathsf{C}}
\newcommand{\K}{\mathsf{K}}
\newcommand{\J}{\mathsf{J}}
\newcommand{\T}{\mathsf{T}}
\newcommand{\Kl}{\mathsf{Kl}}

\newcommand{\FC}{\mathrm{FC}}
\newcommand{\FP}{\mathrm{FP}}
\newcommand{\FS}{\mathrm{FS}}
\newcommand{\UC}{\mathrm{UC}}
\newcommand{\UP}{\mathrm{UP}}
\newcommand{\UG}{\mathrm{UG}}

\newcommand{\op}{\mathrm{op}}
\newcommand{\Obj}{\mathrm{Ob}}

\newcommand{\pic}{$\pi$-calculus}

\newcommand{\pfk}{\pitchfork}
\newcommand{\maps}{\colon}
\newcommand{\id}{\mathrm{id}}

\begin{document}

\title{Enriched Lawvere Theories \\
for Operational Semantics}

\maketitle
\begin{center}   
  {\em John\ C.\ Baez \\}
  \vspace{0.3cm}
  {\small
 Department of Mathematics \\
    University of California \\
  Riverside CA, USA 92521 \\ and \\
 Centre for Quantum Technologies  \\
    National University of Singapore \\
    Singapore 117543  \\    } 
  \vspace{0.4cm}
{\em Christian Williams \\}
\vspace{0.3cm}
   {\small
   Department of Mathematics \\
  University of California \\
  Riverside CA, USA 92521 \\}
  \vspace{0.3cm}   
  {\small email:  baez@math.ucr.edu, cwill041@math.ucr.edu\\} 
  \vspace{0.3cm}   
  {\small \today}
  \vspace{0.3cm}   
\end{center} 

\begin{abstract} 
Enriched Lawvere theories are a generalization of Lawvere theories that allow us to describe operational semantics for formal systems.  For example, a graph-enriched Lawvere theory describes structures that have a \emph{graph} of operations of each arity, where the vertices are operations and the edges are rewrites going between operations. Enriched theories can be used to equip systems with operational semantics, and maps between enriching categories can serve to translate between different forms of operational and denotational semantics. We use a definition of Lucyshyn-Wright which allows for theories to be parameterized by a monoidal subcategory of arities, and show that presentation of enriched Lawvere theories is simplified by restricting to natural number arities. We illustrate these ideas with the $SKI$ combinator calculus, a variable-free version of the lambda calculus, presented as a graph-enriched theory.  
\end{abstract}

\section{Introduction}

Formal systems are sometimes defined without intrinsic connection to how they actually operate in practice.   Lawvere theories  \cite{lawvere} are an excellent formalism for describing algebraic structures obeying equational laws, but they do not specify how to compute in such a structure, for example taking a complex expression and simplifying it using rewrite rules.   Recall that a Lawvere theory is a category with finite products $\T$ generated by a single object $t$, for ``type'', and morphisms $t^n \to t$ representing $n$-ary operations, with commutative diagrams specifying equations.   There is a theory for groups, a theory for rings, and so on.   We can specify algebraic structures of a given kind in some category $\C$ with finite products by a power-preserving functor $\mu \maps\T \to \C$.   This is a simple and elegant form of \emph{denotational} semantics.    However, Lawvere theories know nothing of \emph{operational} semantics.  Our goal here is to address this using ``enriched'' Lawvere theories.

In a Lawvere theory the objects are types and the morphisms are terms; the problem is that
there are no rewrites between terms, only equations.   In operational semantics, program behavior is often specified by labelled transition systems, or labelled directed graphs \cite{sos}.  The edges of such a graph can be seen as rewrites:
\begin{center}\begin{tikzcd}(\lambda x.x+x \; \; 2) \ar{r}{\beta} & 2+2 \ar{r}{+} & 4\end{tikzcd}\end{center}
To bring rewrites into Lawvere theories we need a structure with types, terms, and also rewrites
between terms.   This suggests using an enhanced Lawvere theory where instead of merely
a \emph{set} of morphisms between objects one has a \emph{graph} or perhaps a \emph{category}. Enriched Lawvere theories are perfectly suited for this purpose.

Using enriched Lawvere theories for operational semantics has been explored in the past. For example, category-enriched theories have been studied by Seely \cite{seely}, and poset-enriched ones by Ghani and L\"uth \cite{ghani}.  Here we allow quite general enrichments, to incorporate these approaches in a common framework.  We focus attention on graph-enriched Lawvere theories, which have a clear connection to the original idea of operational semantics:

\[\begin{array}{rl}
\text{sorts} & \text{: generating object } t\\
\text{term constructors} & \text{: generating morphisms } t^n \to t\\
\text{structural congruence} & \text{: commuting diagrams}\\
\text{\textasteriskcentered \quad rewrite rules} & \text{: generating hom-edges\quad\textasteriskcentered}\\
\end{array}\]

However, there are many other useful enriching categories.  For any enriching category $\V$, a \define{$\V$-theory} is a $\V$-enriched Lawvere theory with natural number arities (see $\S$4). Even better, there are functors between these which allow the seamless translation between different kinds of operational and denotational semantics.  There is a \textit{spectrum} of enriching categories which allow us to examine the semantics of term calculi at various levels of detail:

\begin{itemize}
\item 
\textbf{Graphs}: $\Gph$-theories represent ``small-step" operational semantics \\ --- a hom-graph edge represents a \textit{single term} rewrite.
\item
\textbf{Categories}: $\Cat$-theories represent ``big-step" operational semantics*\\ --- composition generates morphisms representing \textit{big-step} rewrites\\ (*Conventionally, a big-step rewrite is one resulting in a ``normal form'', i.e. an expression which has been computed completely. We will use the term more generally.) 
\item
\textbf{Posets}: $\Pos$-theories represent ``full-step" operational semantics:\\ --- a hom-poset boolean represents the \textit{existence} of a big-step rewrite.
\item
\textbf{Sets}: $\Set$-theories represent denotational semantics: \\ --- a hom-set element represents an \textit{equivalence class} of the symmetric closure of the big-step relation.
% say somewhere else the caveat about confluence, with reference to \cite{lam}.  What's the precise reason we should require confluence here?
\end{itemize}
Here we take $\Gph$ to be the category of reflexive graphs, $\Set^R$, where $R$ is the category with two objects $v$ and $e$, two morphisms $s,t \maps e \to v$, and a morphism $i \maps v \to e$ obeying $si = ti = 1_v$.  Thus, every vertex has a distinguished self-loop, which is needed for the ``free category'' functor to be a valid change-of-semantics ($\S$6).   We could also handle labelled transition systems by a simple augmentation of this theory, but for simplicity we do not consider these.

In section $\S2$, we review Lawvere theories as a more explicit, but equivalent, presentation of finitary monads. In $\S3$, we recall the basics of enrichment, and especially the theory of powers.  In $\S4$ we give the central definition of $\V$-theory, from Lucyshyn-Wright \cite{lucyshyn-wright}, which allows us to parametrize our theory by a monoidal subcategory of arities.

In $\S5$ we discuss how functors between enriching categories induce change-of-base 2-functors between their 2-categories of enriched categories, and in $\S6$ we show that functors preserving finite products induce \textit{change-of-semantics}: that is, they map theories to theories and models to models.   Our main examples arise from this chain of adjunctions:
\[\begin{tikzcd}[column sep=small]
\Gph \arrow[bend left,below]{rr}{\FC}
& \ld &
\arrow[bend left,above]{ll}{\UG} \Cat \arrow[bend left,below]{rr}{\FP}
& \ld &
\arrow[bend left,above]{ll}{\UC} \Pos \arrow[bend left,below]{rr}{\FS}
& \ld &
\Set \arrow[bend left,above]{ll}{\UP}
\end{tikzcd}\]
The right adjoints here automatically preserve finite products, but the left adjoints 
do as well, and these are more important in applications:
\begin{itemize}
\item 
Change of base along $\FC \maps \Gph \to \Cat$ maps small-step operational semantics to big-step operational semantics.
\item
Change of base along $\FP \maps \Cat \to \Pos$ maps big-step operational semantics to full-step operational semantics.
\item
Change of base along $\FS \maps \Pos \to \Set$ maps full-step operational semantics to
denotational semantics.
\end{itemize}

In $\S7$ we show that models of all possible theories with all possible enrichments can be assimilated into one category using the Grothendieck construction.  Finally, in $\S8$ we bring all the strands together by demonstrating these concepts with the $SKI$-combinator calculus, introducing the idea of developing actual programming languages with enriched Lawvere theories.

\subsection*{Acknowledgements}

This paper builds upon the ideas of Mike Stay and Greg Meredith presented in ``Representing operational semantics with enriched Lawvere theories''  \cite{roswelt}.  We appreciate their offer to let us develop this work further for use in the innovative distributed computing system RChain, and gratefully acknowledge the support of Pyrofex Corporation. 

\section{Lawvere Theories}

Algebraic structures are traditionally treated as sets equipped with operations obeying equations, but we can generalize such structures to live in any category with finite products.  For example,
given any category $\C$ with finite products, we can define a monoid internal to $\C$ to consist of:
\[\begin{array}{rl}
\text{an object} & M\\
\text{an identity element} & e\maps 1 \to M\\
\text{and multiplication} & m\maps M^2 \to M\\
\text{obeying the associative law} & m \circ (m \times M) = m \circ (M \times m)\\
\text{and the right and left unit laws} & m \circ (e  \times \id_M) = \id_M = m \circ (\id_M \times e).\\
\end{array}\]
Lawvere theories formalize this idea.  For example, there is a Lawvere theory $\Th(\Mon)$, the category with finite products freely generated by an object $t$ equipped with an identity element $e \maps 1 \to t$ and multiplication $m \maps t^2 \to t$ obeying the associative law and unit laws listed above.    This captures the ``Platonic idea'' of a monoid internal to a category with finite products.  A monoid internal to $\C$ then corresponds to a functor $\mu \maps \T \to \C$ that preserves finite products.  

In more detail, let $\NN$ be any skeleton of the category of finite sets $\FinSet$.  Because $\NN$ is the free category with finite coproducts on $1$, $\NN^\op$ is the free category with finite products on $1$.   A \define{Lawvere theory} is a category with finite products $\T$ equipped with a functor $\tau \maps \NN^\op \to \T$ that is bijective on objects and preserves finite products.   Thus, a Lawvere theory is essentially a category generated by one object $\tau(1) = t$ and $n$-ary operations $t^n \to t$, as well as the projection and diagonal morphisms of finite products.

For efficiency let us call a functor that preserves finite products \define{cartesian}.   Lawvere theories are the objects of a category $\Law$ whose morphisms are cartesian functors $f \maps \T\to \T'$ that obey $f\tau = \tau'$.   More generally, for any category with finite products $\C$, a \define{model} of the Lawvere theory $\T$ in $\C$ is a cartesian functor $\mu \maps \T \to \C$.  The models of $\T$ in $\C$ are the objects of a category $\Mod(\T,\C)$, in which the morphisms are natural transformations.  

A theory can thus have models in many different contexts.   For example, there is a Lawvere theory $\Th(\Mon)$, the theory of monoids, described as above.  Ordinary monoids are models of this theory in $\Set$, while topological monoids are models of this theory in $\Top$.

For completeness, it is worthwhile to mention the \textit{presentation} of a Lawvere theory: after all, we are arguing their utility in everyday programming.  How exactly does the above ``sketch'' of $\Th(\Mon)$ produce a category with finite products?  It is precisely analogous to the presentation of an algebra by generators and relations: we form the free category with finite products on the data given, and impose the required equations.  The result is a category whose objects are powers of $M$, and whose morphisms are composites of products of the morphisms in $\Th(\Mon)$, projections, deletions, symmetries and diagonals.  A detailed account was given by Barr and Wells \cite[Chap.\ 4]{barrwells}; for a more computer-science-oriented approach see Crole \cite[Chap.\ 3]{crole}.

\iffalse
\begin{center}
	\begin{minipage}{.2 \textwidth}
		\begin{prooftree}
			\Axiom$a \; ,\; b \fCenter \; :\T$
			\UnaryInf$a\times b \fCenter \; : \T$
		\end{prooftree}
	\end{minipage} \qquad
	\begin{minipage}{.2 \textwidth}
		\begin{prooftree}
			\Axiom$f \; :a\to b\; \fCenter ,\; g\; :c\to d$
			\UnaryInf$f\times g \; : \; a\;\times\fCenter \;b \; \to c\times d$
		\end{prooftree}
	\end{minipage} \qquad \qquad
	\begin{minipage}{.2 \textwidth}
		\begin{prooftree}
			\Axiom$h: d\to a\; ,\; \fCenter k:e\to b$
			\doubleLine
			\UnaryInf$\big\langle h,k \big\rangle :\; e \fCenter\;\to a\times b$
		\end{prooftree}
	\end{minipage}
\end{center}
\begin{center}
\begin{minipage}{.2 \textwidth}
	\begin{prooftree}
		\Axiom$a\times b \; \fCenter : \T$
		\UnaryInf$\pi_1 : a\times b\to a \; \fCenter \; ,\; \pi_2 : a\times b\to b$
	\end{prooftree}
\end{minipage} \qquad \qquad \qquad
\begin{minipage}{.2 \textwidth}
	\begin{prooftree}
		\Axiom$\big\langle h,k \big\rangle :\; e\; \fCenter\to a\times b$
		\UnaryInf$\pi_1 \big\langle h,k \big\rangle \equiv h \; \fCenter ,\; \pi_2 \big\langle h,k \big\rangle \equiv k$
	\end{prooftree}
\end{minipage}
\end{center}
\fi

Currently, monads are more widely used in computer science than Lawvere theories.  However, Hyland and Power have suggested that Lawvere theories could do much of the work that monads do today \cite{hylandpower}. In 1965, Linton \cite{linton} proved that Lawvere theories correspond to ``finitary monads'' on the category of sets.   For every Lawvere theory $\T$, there is an adjunction:
\[\begin{tikzcd}[column sep=small]
\Set \arrow[bend left,below]{rr}{F}
& {\phantom{AA} \ld} &
\arrow[bend left,above]{ll}{U} \Mod(\T,\Set).
\end{tikzcd}\]
The functor 
\[  U \maps \Mod(\T,\Set) \to \Set \]
sends each model $\mu$ to its underlying set, $X = \mu(\tau(1))$. 
Its left adjoint, the free model functor 
\[       F \maps\Set \to \Mod(\T,\Set), \]
sends each finite set $n \in \NN$ to the representable functor $\T(\tau(n),-)\maps \T \to \Set$, and in general any set $X$ to the colimit of all such representables as $n$ ranges over the poset of finite subsets of $X$.   In rough terms, $F(X)$ is the set of all possible $n$-ary operations from $\T$ on the set $X$.

If we momentarily abbreviate $\Mod(\T,\Set)$ as $\Mod$, we obtain an adjunction
\[   \Mod(F(n),\mu) = \Mod(\T(\tau(n),-),\mu) \cong \mu(\tau(n)) \cong \mu(\tau(1))^n = \Set(n,U(\mu))\] 
where the left isomorphism arises from the Yoneda lemma, and the right isomorphism from the product preservation of $\mu$.   

This adjunction induces a monad $T$ on $\Set$:
\begin{equation}
T(X) = \int^{n\in \NN} X^n \times \T(n,1).
\end{equation}
The integral here is a coend, essentially a coproduct quotiented by the equations of the theory and the equations induced by the cartesian structure of the category.    The monad constructed this way is always \define{finitary}: that is, it preserves filtered colimits \cite{adamekrosicky}.

Conversely, for a monad $T$ on $\Set$, its Kleisli category $\Kl(T)$ is the category of all free algebras of the monad, which has all coproducts. There is a functor $k\maps \Set \to \Kl(T)$ that is the identity on objects and preserves coproducts (because it is a right adjoint).  Thus,
\[ k^{\op}\maps \Set^{\op} \to \Kl(T)^{\op} \]
is a cartesian functor, and restricting its domain to $\NN^{\op}$ is a Lawvere theory. 
When $T$ is finitary, the monad arising from this Lawvere theory is naturally isomorphic to $T$ itself.  For more details see \cite{barrwells,lawvere,milewski}.

This correspondence sets up an equivalence between the category $\Law$ of Lawvere theories and the category of finitary monads on $\Set$.  There is also an equivalence of between the category $\Mod(\T)$ of models of any given Lawvere theory and the category of algebra of the corresponding finitary monad $T$.  Furthermore, all this generalizes with $\Set$ replaced by any ``locally finitely presentable'' category \cite{adamekrosicky}.   

\section{Enrichment}

To allow more general semantics, we now turn to Lawvere theories that have hom-\emph{objects} rather than mere hom-\emph{sets}.  To do this we use enriched category theory \cite{kelly}, where we replace sets with objects of a monoidal category  $(\V,\otimes,I)$, the ``enriching'' category.   A \textbf{$\V$-category} or $\V$-enriched category $\C$ is:
\[\begin{array}{rl}
\text{a collection of objects} & \Obj(\C)\\
\text{a hom-object function} & \C(-,-)\maps \Obj(\C) \times \Obj(\C) \to \Obj(\V)\\
\text{composition morphisms} & \circ_{a,b,c}\maps\C(b,c) \otimes \C(a,b) \to \C(a,c) \quad \forall a,b,c \in \Obj(\C)\\
\text{identity-assigning morphisms} & i_a\maps I\to\C(a,a) \quad \forall a \in \Obj(\C)\\
\end{array}\]
such that composition is associative and unital.  A \textbf{$\V$-functor} $F\maps\C \to \D$ is:
\[\begin{array}{rl}
\text{a function} & F_0\maps \Obj(\C) \to \Obj(\D)\\
\text{a collection of morphisms} & F_{ab}\maps \C(a,b) \to \D(F_0(a),F_0(b)) \quad \forall a,b \in \C\\
\end{array}\]
such that $F$ is compatible with composition and identity.  A \textbf{$\V$-natural transformation} $\alpha\maps F \Rightarrow G$ is:
\[\begin{array}{rl}
\text{a family} & \alpha_a\maps I \to \D(F_0(a),G_0(a)) \quad \forall a \in \Obj(\C)\\
\end{array}\]
such that $\alpha$ is ``natural'' in $a$.   There a 2-category \textbf{$\V\Cat$} of $\V$-categories, $\V$-functors, and $\V$-natural transformations. 

To go further, let $\V$ be a symmetric monoidal closed category, providing
\[\begin{array}{rl}
\text{internal hom} & [-,-]\maps\V^\op \times \V \to \V\\
\text{tensor-hom adjunction} & \V(u\otimes v,w) \cong \V(u,[v,w]) \quad \forall u,v,w \in \Obj(\V)\\
\text{braiding natural isomorphism} & \tau_{u,v}\maps u \otimes v \cong v \otimes u \quad \forall u,v \in \Obj(\V)\\
\end{array}\]
obeying the hexagon and triangle equations and the symmetry axiom saying $\tau_{u,v}$ is the inverse of $\tau_{v,u}$ \cite{maclane}.   Then we can construct new $\V$-categories from old by taking tensor products and opposites in an obvious way.   Moreover $\V$ is itself a $\V$-category, denoted $\tilde{\V}$, with the hom-object function providing the internal hom.  The tensor-hom adjunction is called ``currying'' in computer science; the counit is ``evaluation''.  

Generalizing how the symmetric monoidal closed category $\V$ has a tensor product and internal hom, a $\V$-category can be ``$\V$-tensored'' and ``$\V$-powered''.   
Suppose $\C$ is any $\V$-category.  Given $a \in \C$ and $v \in \V$, we say an object 
$v \odot a \in \C$ is a \define{tensor product} of $a$ by $v$ if it is equipped with isomorphisms
\begin{equation}\label{eq:tensor}
	\C(v\odot a,b) \cong \left[v, \C(a,b)\right]
\end{equation}
$\V$-natural in $b$.
In the special case $\V = \Set$ this forces $v \cdot a$ to be the $v$-fold coproduct 
of copies of $a$:
\[       v \odot a = \sum_{i \in v} a . \]
In general, if we can choose a tensor product $v \odot a$ for all $v \in \V$, $a \in C$
we say $\C$ is \textbf{$\V$-tensored}, and we obtain a $\V$-functor
\[
	\odot \maps \tilde{\V} \otimes \C \to \C.
\]
For example, $\tilde{\V}$ is always $\V$-tensored via the tensor product
$ \otimes \maps \tilde{\V} \otimes \tilde{\V} \to \tilde{\V} $.

Similarly, given $b \in \C$ and $v \in \V$, we say an object $v \pfk b \in \C$ is a \define{power} of $b$ by $v$ if it is equipped with isomorphisms
\begin{equation}\label{eq:power}
		 \left[v, \C(a,b)\right] \cong \C(a,v\pfk b) .
\end{equation}
$\V$-natural in $a$.  In the special case $\V = \Set$  this forces $v \pfk a$ to be the $v$-fold product of copies of $b$:
\[          v \pfk b = \prod_{i \in v} b . \]
In general, if we can choose a power $v \odot b$ for all $v \in \V$, $b \in C$
we say $\C$ is \textbf{$\V$-powered}, and we obtain a $\V$-functor
\[
\pfk \maps \tilde{\V}^\op \otimes \C \to \C .
\]
For example, $\tilde{\V}$ is always $\V$-powered via the internal hom
$[-,-] \maps \V^\op \times \V \to \V $.

When $\C$ is both $\V$-tensored and $\V$-powered, we have isomorphisms
\begin{equation}\label{eq:co-power}
	\C(v\odot a,b) \cong \left[v, \C(a,b)\right] \cong \C(a,v \pfk b).
\end{equation}
that are  $\V$-natural in $a,b \in \C$ and $v \in \V$.  When $\V = \Set$ this occurs if $\C$ has all products and coproducts.    In what follows we use exponential notation $b^v := v\pfk b$ for $\V$-powers, and denote the unit $I$ by $1$, because the enriching categories we consider are cartesian.  We should note that tensors are sometimes called ``copowers'', and powers are sometimes called ``cotensors''.

There are just a few more technicalities. A category is \textbf{locally finitely presentable} if it is the category of models for a finite limits theory, and an object is \define{finite} if its representable functor is \define{finitary}: that is, it preserves filtered colimits \cite{adamekrosicky}.   A $\V$-category $\C$ is \textbf{locally finitely presentable} if its underlying category $\C_0$ is locally finitely presentable, $\C$ has finite powers, and $(-)^x\maps \C_0 \to \C_0$ is finitary for all finitely presentable $x$.  The details are not crucial here: all categories to be considered are locally finitely presentable. We will use  $\V_f$ to denote the full subcategory of $\V$ of finite objects: in $\Gph$, these are simply graphs with finitely many vertices and edges.

Even though the definition of Lawvere theory seems to be all about products, it is actually about \textit{powers}, because these constitute the arities of the operations. These are greatly generalized in the enriched case, because whereas the only finite objects in $\Set$ are \textit{finite sets}, there are more complex finite objects in any other enriching $\V$.  In the next section we discuss some difficulties of this generality and how to circumvent them.

\section{Enriched Lawvere theories}

Power introduced the notion of enriched Lawvere theory about twenty years ago, ``in seeking a general account of what have been called notions of computation'' \cite{power}. The original definition is as follows: for a symmetric monoidal closed category $(\V,\otimes,1)$, a ``$\V$-enriched Lawvere theory'' is a $\V$-category $\T$ that has powers by objects in $\V_f$, equipped with an identity-on-objects $\V$-functor 
\[  \tau\maps \V_f^\op \to \T \]
that preserves these powers.  A ``model'' of a $\V$-theory is a $\V$-functor $\mu\maps\T \to \V$ which preserves powers by finite objects of $\V$.  There is a category $\Mod(\T,\V)$ whose objects are models and whose morphisms are $\V$-natural transformations. The monadic adjunction and equivalence of $\S$2 generalize to this context.

However, this sort of $\V$-enriched Lawvere theory has arities for every finite object of $\V$.  These \textit{generalized arities} may be very powerful---rather than only inputting $n$-tuples of terms, we can input any finite object of terms.  Despite its potential, this generalization remains largely unexploited in computer science.   Power \cite{powsketch} introduced``enriched sketches'' as a way of presenting enriched Lawvere theories, and ``monads with arities'' have been explored by Berger, Melli\'es and Weber \cite{bergermelliesweber}, but they are still not yet widely understood or used.  What does it really mean for an operation to take in a finite graph of terms?  How can we learn to use this generality?  We hope that someone answers these questions, so that we can use more general arities in computer programming.

%partly for the difficulty of intuition, but also that of presentation: while it is easy to inductively generate all $n$-ary operations from binary, unary, nullary ones, it is certainly more subtle to generate powers for all finite objects.

In this paper, however, we only consider \textit{natural number} arities, while still retaining enrichment. To do this we use the work of Lucyshyn-Wright \cite{lucyshyn-wright}, who along with Power \cite{np} has generalized Power's original ideas to allow a more flexible choice of arities.    For simplicity, we also limit ourselves to the case where the tensor product of $\V$ is cartesian.  

Thus, in all that follows, we let $(\V,\times,1_\V)$ be a cartesian closed category equipped with chosen finite coproducts of the terminal object $1_\V$, say 
\[   n_\V : = \sum_{i \in n} 1_\V . \]  
These objects come with natural isomorphisms
\begin{equation}
\V(n_\V,a) \cong\V(1_\V,a)^n .
\end{equation}
Define $\NN_\V$ to be the full subcategory of $\V$ containing just these objects $n_\V$, and let
\[ j \maps \NN_\V \hookrightarrow \V \]
be the inclusion.  There is also a $\V$-category $\tilde{\NN}_\V$ whose objects are those of $\NN_\V$ and whose hom-objects are given as in $\V$:
\[         \hom(a,b) = [j(a), j(b)]   \]
for all $a,b \in \NN_\V$.

\begin{definition}
\label{defn:V-theory}
We define a \textbf{$\V$-theory} $(\T,\tau)$ to be a $\V$-category $\T$ 
equipped with a $\V$-functor 
\[ \tau  \maps\tilde{\NN}_\V^\op \to \T \]
that is bijective on objects and \textbf{$\NN_\V$-power-preserving}: that is, it preserves powers by objects of (the subcategory image of) $\NN_\V$. 
\end{definition}
\noindent
This definition is adapted from that of Lucyshyn-Wright \cite{lucyshyn-wright}.  While he demands that $\tau$ be the identity on objects, we allow it to be bijective on objects, to more easily handle change of base.

\begin{definition}
A \textbf{model} of $\T$ in a $\V$-category $\C$ is a $\NN_\V$-power-preserving $\V$-functor 
\[  \mu \maps \T \to \C.\]
\end{definition}

In the same way that all the objects of a Lawvere theory are $\NN$-powers of a single object, we can see that all the objects of a $\V$-theory are $\NN_\V$-powers $t^{n_\V}$ of the object 
\[   t = \tau(1_\V) .\]   
Note that $t$ itself is $t^{1_\V}$.  Moreover, just as every object of $\NN^\op$ is a power of $1$, every object of $\NN_\V^\op$ is a power of $1_\V$.  This fact comes from the isomorphism $n_\V \cong n_\V^1$ in $\NN_\V$ by taking opposites.   Then, since $\tau$ preserves $\NN_\V$-powers and is bijective on objects, it follows that every object of $\T$ is an $\NN_\V$-power of $t$.

Thus, the full sub-$\V$-category $\tilde{\NN}_\V$ has hom-objects which behave as follows:
\[\begin{tikzcd}
\left[n_\V,m_\V\right] \cong (m\cdot 1_\V)^n \cong (m^n)_\V.
\end{tikzcd}\]
CHECK!!!

\begin{definition}
We define the \define{category of} $\V$\define{-theories}, $\V\Law$, to be the category for which an object is a $\V$-theory and a morphism from $(\T,\tau)$ to $(\T',\tau')$ is an $\NN_\V$-power-preserving $\V$-functor $f\maps \T \to \T'$ such that $f\tau = \tau'$. 
\end{definition}

\begin{definition}
For every $\V$-theory $(\T,\tau)$ and every $\V$-category $\C$ with $\NN_\V$-powers, we define the \define{category of models} of $\T$ in $\C$, $\Mod(\T,\C)$, to consist of $\NN_\V$-power preserving $\V$-functors $\T\to \C$ and $\V$-natural transformations between these.
\end{definition}

If $\V$ is complete and cocomplete, then $\V\Law$ and $\Mod(\T,\C)$ naturally become $\V$-categories. This is potentially very useful, and the enriching categories $\V = \Gph, \Cat, \Pos, \Set$ that are the focus of this paper are indeed complete and cocomplete.

The basic monadicity results for Lawvere theories generalize to $\V$-theories.
It follows from the work of Lucyshyn-Wright \cite[Sec.\ 8]{lucyshyn-wright} that we have a $\V$-enriched adjunction
\[\begin{tikzcd}[column sep=small]
\phantom{AA} \V \arrow[bend left,below]{rr}{F}
& {\phantom{Aa} \ld} &
\arrow[bend left,above]{ll}{U} \Mod(\T,\V).
\end{tikzcd}\]
The forgetful $\V$-functor $U \maps \Mod(\T,\V) \to \T$ is evaluation at $t \in \T$.   Its left
adjoint $F$ relies on the existence of the \textbf{free model} on an object $n_\V \in \V$.   This is the enriched generalization of the free model described in $\S$2: it is the composite of $\tau^\op\maps \tilde{\NN}_\V^\op \to \T^\op$ with the enriched Yoneda embedding $y\maps \T^\op \to [\T,\V]$:
\[\begin{array}{rllll}
\NN_\V^\op & \xrightarrow{\tau^\op} & \T^\op & \xrightarrow{y} & \left[\T,\V\right]\\
\\
n_\V & \mapsto & t^{n_\V} & \mapsto & \T(t^{n_\V},-)
\end{array}\]
Since an object of $\V$ does not necessarily have a ``poset of finite subobjects'' over which to take a filtered colimit (as in $\Set$), the extension of this ``free model'' functor $y \tau^\op$ to all of $\V$ is specified by a somewhat higher-powered generalization: it is the left Kan extension of $y\tau$ along $j$:
\[\begin{tikzcd}
\NN_\V \arrow[rr,"y\tau^\op"{name=y}] \arrow[swap,rd,"j"] & & \left[\T,\V\right].\\
& \V \arrow[swap,dotted, ru,"F:=\mathrm{Lan}_jy\tau"] \arrow[Rightarrow,from=y,"\eta", shorten >=0.2cm,shorten <=.2cm]
\end{tikzcd}\]
This is essentially the universal ``best solution'' to the problem of making the triangle commute up to a natural transformation.  That is, for any functor $G \maps \V \to [\T,\V]$ and $\V$-natural transformation $\theta \maps y\tau \Rightarrow Gj$, the latter factors uniquely through $\eta$.

From the adjunction between $\V$ and the category of models $\Mod(\T,\V)$ we obtain a $\V$-enriched monad
\[       T = U F \maps \V \to \V, \]
and this has a more concrete formula as an enriched coend:
\begin{equation}
T(V) = \int^{n_\V\in \NN_\V} V^{n_\V} \times \T(t^{n_\V},t)
\end{equation}
Finally, it follows from Thm.\ 8.9 and Example 7.5.2 of Lucyshyn-Wright \cite{lucyshyn-wright} that 
$\Mod(\T,\V)$ is $\V$-monadic over $\V$ via this $\V$-enriched monad $T$.

\begin{example}
When $\V = \Cat$, a $\V$-category is a 2-category, so a $\V$-theory deserves to be called a \define{2-theory}.  For example, let $\T = \Th(\mathrm{PsMon})$ be the 2-theory of pseudomonoids \cite{pseudo}.   A pseudomonoid is a weakened version of a monoid: rather than associativity and unitality \textit{equations}, it has 2-isomorphisms called the associator and unitors, which we can treat as \textit{rewrite rules}.  To equate various possible rewrite sequences, these 2-isomorphisms must obey equations called ``coherence laws''.  Here is a presentation of the 2-theory for pseudomonoids:
	\[ \textbf{Th(PsMon)} \]
	\[\begin{array}{rll}
	\textbf{sorts} & M & \text{pseudomonoid}\\
	\textbf{operations} & e\maps1 \to M & \text{identity}\\
	& m\maps M^2 \to M & \text{multiplication}\\
	\textbf{rewrites} & \alpha \colon m \circ (m \times \id_M) \stackrel{\sim}{\Longrightarrow} m \circ (\id_M \times m) & \text{associator}\\
	& \lambda\maps  m \circ (e \times \id_M) \stackrel{\sim}{\Longrightarrow} \id_M & \text{left unitor}\\
	& \rho\maps m \circ (\id_M \times e) \stackrel{\sim}{\Longrightarrow} \id_M & \text{right unitor}\\
	\textbf{coherence laws}
          \end{array}\]

        \[\begin{tikzcd}
          M^4 \ar[rr,"1\times 1\times m"] \ar[dr,"1\times m\times 1" description, ""name=a1] \ar[dd, "m\times 1\times 1",swap,""name=b1] && M^3 \ar[dr, "1\times m",""name=a2] \arrow[Rightarrow,"1\times \alpha",from=a1,to=a2,shorten >=1.3cm,shorten <=1.3cm] &&& M^4 \ar[rr, "1\times 1\times m"] \ar[dd,"m\times 1\times 1",swap,""name=d1] && M^3 \ar[dd,"m\times 1" description,""name=d2] \ar[dr,"1\times m"] %\arrow[,"",from=d1,to=d2,shorten >=1.3cm,shorten <=1.3cm] 
          & \\
          & M^3 \ar[rr,"1\times m"] \ar[dd,"m\times 1",""name=b2] \arrow[Rightarrow,"\alpha\times 1",from=b1,to=b2,shorten >=0.7cm,shorten <=0.7cm] && M^2 \ar[dd,"m",""name=c1] & = & &&& M^2 \ar[dd,"m",""name=f1] \arrow[Rightarrow,"\alpha",from=d2,to=f1,shorten >=0.6cm,shorten <=0.6cm] \arrow[Rightarrow,"\alpha",from=b2,to=c1,shorten >=1.3cm,shorten <=1.3cm] \\
          M^3 \ar[dr,"m\times 1",swap] &&& && M^3 \ar[rr,"1\times m"] \ar[dr,"m\times 1",swap,,""name=e1] && M^2 \ar[dr,"m",,""name=e2] \arrow[Rightarrow,"\alpha",from=e1,to=e2,shorten >=1.3cm,shorten <=1.3cm] & \\
          & M^2 \ar[rr,"m",swap] && M && & M^2 \ar[rr,"m",swap] && M
        \end{tikzcd}\]

      \[\begin{tikzcd}
          & M^2 \ar[dl,"1\times e\times 1",""name=a1,swap] \ar[dr,"1",""name=a2] \arrow[Rightarrow,from=a1,to=a2,"1\times \lambda",swap,shorten >=0.4cm,shorten <=0.4cm] & && & M^2 \ar[dl,"1\times e\times 1",swap] \ar[dr,"1"] \ar[ddl,bend left =30,looseness=2, "1",""name=c1] & \\
          M^3 \ar[d,"m\times 1",swap,""name=b1] \ar[rr,"1\times m",swap] && M^2 \ar[d,"m",""name=b2] \arrow[Rightarrow,from=b1,to=b2,"\alpha",shorten >=1.3cm,shorten <=1.3cm,swap] & = & M^3 \ar[d,"m\times 1",swap] \arrow[Rightarrow,to=c1,"\rho\times 1",shorten >=0.4cm,shorten <=0.0cm] && M^2 \ar[d,"m"] \\
          M^2 \ar[rr,"m",swap] && M && M^2 \ar[rr,"m",swap] && M
        \end{tikzcd}\]
    \end{example}   
\noindent The top diagram expresses the pentagon identity for the associator, while the bottom one expresses the usual coherence law involving the left and right unitors.  CHECK - SHOULDN'T THERE BE TWO UNITOR LAWS???
   
Models of $\T = \Th(\mathrm{PsMon})$ in $\Cat$ are monoidal categories.   A $\Cat$-enriched monad is called a 2-monad, and $\T$ gives rise to the ``free monoidal category'' 2-monad on $\Cat$ \cite{bkp}.
Let us explore this example in more detail.  A model of $\T$ is a finite-product-preserving 2-functor $\mu\colon \T\to \Cat$, which sends 
\[\begin{array}{rclcl}
	t & \mapsto & \C &&\\
	m & \mapsto & \otimes\maps & \C^2 \to \C &\\
	e & \mapsto & I\maps & 1\to \C &\\
	\alpha & \mapsto & \otimes \circ (\otimes \times 1_\C) & \Rightarrow & \otimes \circ (1_\C \times \otimes)\\
	\lambda & \mapsto & I\circ 1_\C & \Rightarrow & 1_\C\\
	\rho & \mapsto & 1_\C \circ I & \Rightarrow & 1_\C
\end{array}\]
such that the coherence laws of the rewrites are preserved.  Thus, a model is a category equipped with a tensor product $\otimes$ and unit object $I$ such that these operations are unital and associative up to natural isomorphism; so these models are precisely monoidal categories. In this way, 2-theories generalize equipping \textit{set}-like objects  with operations obeying equations to equipping \textit{category}-like objects with operations obeying equations up to 
transformations that obey certain equations of their own.

To form the free model on a category $\C\in \Cat$, we follow the above method: the formula for left Kan extension (writing $n$ instead of $n_\Cat$ for simplicity) gives $F(\C)\maps \T\to \V$ by 
\[   F(\C) = \int^{n\in \NN_\Cat} \T(t^{n},t^{(-)})\times \C^{n} \] 
which is constructed by pairing $n$-ary morphisms in $\T$ with $n$-tuples of objects in $\C$ for all $n\in \NN_\Cat$, then quotienting the coproduct of these pairs by the equations of $\T$ and $\C$.

This functor is not very intuitive, but composing with the left adjoint, i.e., evaluating $F(\C)$ at $1$, gives the \textit{free monoidal category} on $\C$: in the same way that the (underlying set of the) free monoid on a set $X$ consists of all finite strings of elements of $X$, $F(\C)(1)$ consists of all finite tensors of objects and morphisms of $\C$, and all composites of these morphisms, up to the relations induced by the (composites and tensors of the) images of the associator and unitors.

In general for each $m\in \NN_\Cat$, $F(\C)(m)$ gives the category of all $m$-tuples of elements of $F(C)(1)$, forming the ``free monoidal category on $\C$ with $m$ variables''.  Finally, an algebra of the monad 
\[  T = UF \maps \C \mapsto \int^n \C^n \times \T(n,1) \]
is a category $A$ equipped with a functor $\otimes_A\maps F(A)(1)\to A$ such that it is compatible with the multiplication and unit of the monad, which are the ``free'' tensor bifunctor and monoidal unit on $A$. Hence, $(A,\otimes_A,I_A)$ is precisely a monoidal category, and we have the equivalence: 
\[ \Mod(\T,\Cat) \simeq \mathrm{Alg}(T). \]

\section{Change of Base}

We now have the tools to formulate the main idea: a choice of enrichment for Lawvere theories corresponds to a choice of \textit{semantics}, and changing enrichments corresponds to a \textit{change of semantics}. We propose a general framework in which one can translate between different forms of semantics: small-step, big-step, full-step operational semantics, and denotational semantics.

Suppose that $\V$ and $\W$ are enriching categories of the sort we are considering: 
cartesian closed categories equipped with chosen finite coproducts of the terminal object.
Suppose $F \maps \V \to W$ preserves finite products.   This induces a \textbf{change of base} functor $F_*\maps\V\Cat \to \W\Cat$ \cite{borceux} which takes any $\V$-category $\C$ and produces a $\W$-category $F_*(\C)$ with the same objects but with
\[      F_*(\C)(a,b) := F(\C(a,b)) \]
for all objects $a,b$.   Composition in $F_*(\C)$ is defined by
\[       F(\C(b,c)) \times F(\C(a,b)) \stackrel{\sim}{\longrightarrow} F(\C(b,c) \times \C(a,b)) 
\stackrel{F(\circ_{a,b,c})}{\longrightarrow} F(C(a,b)) . \]  
The identity-assigning morphisms are given by
\[          1 \stackrel{\sim}{\longrightarrow} F(1) \stackrel{F(i_a)}{\longrightarrow}
F(\C(a,b)) .\]
Moreover, if $f\maps \C \to \D \in \V\Cat$ is a $\V$-functor, there is a $\W$-functor $F_*(f) \maps F_*(C) \to F_*(D)$ that on objects equals $f$ and on hom-objects equals $F(f)$.   

We can also define $F_*$ on enriched natural transformations.   If $\alpha\maps f \Rightarrow g$ is a $\V$-natural transformation and $c\in \Obj(\C)$, then we define $F_*(\alpha)_c$ to be the composite
\[      1 \stackrel{\sim}{\longrightarrow} F(1) \stackrel{F(i_a)}{\longrightarrow}
F(\C(a,b)) .\]   
Thus, change of base actually gives a 2-functor from the 2-category of $\V$-categories, 
$\V$-functors and $\V$-natural transformations to the corresponding 2-category for $\W$.

\iffalse
In fact, change of base operation gives a 2-functor
\[\begin{array}{ccc}
\FP\Cat & \xrightarrow{(-)_*} & 2\Cat\\
(F\maps \V\to\W) & \mapsto & (F_*\maps \V\Cat\to\W\Cat)
\end{array}\]
In particular, if $\V$ has not just finite coproducts of the terminal object, but all 
coproducts of this object, there is a map of adjunctions
\[\begin{tikzcd}
	\Set \arrow[bend left,below]{rr}{-\odot 1}
	& \ld &
	\arrow[bend left,above]{ll}{\V(I,-)} \V
	\arrow[maps to]{r}
	& \Cat \arrow[bend left,below]{rr}{(-\odot 1)_*}
	& \ld &
	\arrow[bend left,above]{ll}{(\V(1,-))_*} \V\Cat.
\end{tikzcd}\]
Each set $X$ is mapped to the $X$-indexed coproduct of the terminal object in $\V$ and conversely each object $v$ of $\V$ is represented in $\Set$ by the hom-set from the unit to $v$. The latter induces the ``underlying ($\Set$-)category'' change of base, which forgets the enrichment. The former induces the ``free $\V$-enrichment'' change of base, whereby ordinary $\Set$-categories are converted to $\V$-categories, denoted $\C \mapsto \tilde{\C}$. These form an adjunction, because 2-functors preserve adjunctions.

This is what we implicitly used in the definition of $\V$-theory: the arity category $\NN$ ``sits inside'' many enriching categories under various guises: as finite discrete graphs, categories, posets, etc. For each $\V$ we define the arity subcategory $\NN_\V$ to be the full subcategory of finite coproducts (copowers) of the unit object, and this remains essentially unchanged by the change-of-base to $\tilde{\NN}_\V$.
\fi

We now study how change of base affects theories and their models.  In Theorem \ref{thm:change-of-base} we show that everything works as one would hope, but we need some preliminary work to
show this.  We begin by showing that $n_\V$-powers in the enriched category $\tilde{V}$ are
the same as $n$-fold products in $\V$.  More precisely:

\begin{lemma}
The functors $[n_\V,-]\maps \V\to \V$ and $(-)^n\maps \V\to \V$ are naturally isomorphic.  
\end{lemma}
\begin{proof}
	If $a,b \in \V$, then
	\[\begin{array}{rcll}
	\V(a,[n_\V,b]) & \cong & \V(a\times n_\V,b) & \text{hom-tensor adjunction}\\
	& = & \V(a\times (n \cdot 1_\V),b) & \text{definition of } n_\V\\
	& \cong & \V(n \cdot (a\times 1_\V),b) & \text{distributivity}\\
	& \cong & \V(n\cdot a,b) & \text{unitality}\\
	& \cong & \V(a,b)^n & \text{cocontinuity of hom}\\
	& \cong & V(a,b^n) & \text{continuity of hom}.\\
	\end{array}\]

Each of these isomorphisms is natural in $a$ and $b$; hence by the Yoneda lemma, $[n_\V,-] \cong (-)^n$.
\end{proof}

Now let us consider a $\V$-theory $\T$ as in Definition \label{defn:V-theory}.
All the objects of $\T$ are $n_\V$-powers of a generating object $t$. Alas, we cannot simply say that ``$t^{n_\V} \cong t^n$'', because the latter does not type-check in the $\V$-category $\T$: products are characterized by a $\Set$-enriched universal property. However, we only need:

\begin{lemma}
	Let $\T$ be a $\V$-category with $\NN_\V$-powers, and let $s \in \T$. Then a hom into $s^{n_\V}$ is isomorphic to $n$ homs into $s$: 
\[\begin{tikzcd} \T(a,s^{n_\V}) \cong [n_\V,\T(a,s)] \cong \T(a,s)^n \end{tikzcd}\] 
by definition of power, and Lemma 1.
\end{lemma}

We want to know when the functor $F\maps\V \to \W$ induces a change of base $F_*\maps\V\Cat \to \W\Cat$ which ``preserves enriched-theories''---if by $F$ every $\V$-theory $\tau_\V$ gives rise to a $\W$-theory $\tau_\W$, then $F$ is a \textit{change of semantics}. That is, given a $\V$-theory $$\tau_\V\maps \tilde{\NN}_\V^\op \to \T$$ we want to determine a minimal condition for the base-changed functor $$F_*(\tau_\V)\maps F_*(\tilde{\NN}_\V^\op) \to F_*(\T)$$ to induce a $\W$-theory in a canonical way. So, assuming there is a clear identification of $F_*(\tilde{\NN}_\V^\op)$ and $\tilde{\NN}_\W^\op$, it suffices to require that $F_*(\tau_\V)$ preserves $\NN_\W$-powers.

Because $F_*(-)_{\text{hom}}$ is defined $$F_*(\T)(a,s^{n_\V}) = F(\T(a,s^{n_\V})),$$ combined with the previous lemmas, the preservation of ``$\NN_{(-)}$-power preserving functors'' by $F_*$ is implied by the preservation of finite products by $F$: and since our enriching categories and base-change functors are cartesian, this is automatic.

\begin{lemma}
	Let $F\maps \V \to \W$ be a cartesian functor, and let $\NN_\V$, $\NN_\W$ be defined as above. If $f\maps \C \to \D$ is a $\V$-functor which preserves $\NN_\V$-powers, then $F_*(f)\maps F_*(\C)\to F_*(\D)$ is a $\W$-functor which preserves $\NN_\W$-powers.
\end{lemma}
\begin{proof}
	\[\begin{array}{rcll}
	F_*(\D)(F_*(f)(a),F_*(f)(s^{n_\V})) & = & F(\D(f(a),f(s^{n_\V})) & \text{definition of base change}\\
	& \cong & F(\D(f(a),f(s)^{n_\V}) & f \text{ preserves } \NN_\V \text{-powers}\\
	& \cong & F(\D(f(a),f(s))^n) & \text{Lemma 2 for } \V\\
	& \cong & F(\D(f(a),f(s)))^n & F \text{ cartesian}\\
	& = & F_*(\D)(f(a),f(s))^n & \text{definition of base change}\\
	& \cong & F_*(\D)(f(a),f(s)^{n_\W}) & \text{Lemma 2 for } \W\\
	\end{array}\]
\end{proof}

Finally, let $\tilde{n}\maps \tilde{\NN}_\W \to F_*(\tilde{\NN}_\V)$ be the isomorphism which sends $n_\W \mapsto n_\V$ and is the identity on morphisms. We can then construct a $\W$-functor which precisely fits the definition of a $\W$-theory:

\begin{theorem}
\label{thm:change-of-base}
	Let $\V$, $\W$ be cartesian closed categories with finite coproducts of their unit objects, and let $F\maps \V \to \W$ be a cartesian functor. Then $F$ is a \textbf{change of semantics}; i.e.\ for every $\V$-theory $\tau_\V\maps \tilde{\NN}_\V^\op \to \T$, the $\W$-functor $$\tau_\W := F_*(\tau_\V) \circ \tilde{n}^\op\maps \tilde{\NN}_\W^\op \to F_*(\T)$$ is a $\W$-theory. Moreover, $F$ preserves \textit{models}, i.e.\ for every $\NN_\V$-power preserving $\V$-functor $\mu\maps\T \to \C$, the $\W$-functor $F_*(\mu)$ preserves $\NN_\W$-powers.
\end{theorem}
\begin{proof}
	The $\W$-functor $\tau_\W$ is bijective on objects because $\tau_\V$ and $\tilde{n}$ are; and it preserves $\NN_\W$-powers because $\tilde{N}$ does and $F_*(\tau_\V)$ does by the previous lemma. This preservation is strict because $F_*(\T)$ has the same objects as $\T$, so the isomorphism implies that $\tau_\W(1_\W^{n_\W}) = \tau_\W(1_\W)^{n_\W}$. The preservation of models follows from the previous lemma.
\end{proof}

Hence, any cartesian functor constitutes a ``change of semantics'' --- this is a simple, ubiquitous condition, which provides for a method of translating formal languages between various ``modes of operation''.

Moreover, this reasoning generalizes to \textbf{multisorted} $\V$-theories, enriched theories which have multiple sorts: given any $n\in \mathbb{N}$, the monoidal subcategory $(\NN_\V)^n$ is also an eleutheric system of arities. At the end of $\S$8, we give an example demonstrating why this is a very useful generalization.\\

Before exploring applications, we introduce two more useful kinds of translations, and demonstrate how all of this information be encapsulated in one categorical notion.

\section{The category of all $\V$-theories}

In addition to change-of-base, there are two other natural and useful translations for these theories. Let $\V\mathrm{Law}$ be the category of $\V$-theories, and let $f\maps\T\to \T'$ be a morphism of theories; this induces a ``change-of-theory'' functor between the respective categories of models $$f^*\maps\V\Mod(\T',\C)\to \V\Mod(\T,\C)$$ defined as precomposition with $f$. Similarly, given a cartesian functor $g\maps \C \to \C'$, this induces a ``change-of-model'' functor $$g_*\maps\V\Mod(\T,\C) \to \V\Mod(\T,\C')$$ defined as postcomposition with $g$.

These translations, as well as change-of-base, can all be packed up nicely using the \textbf{Grothendieck construction}: given a (pseudo)functor $F\maps \D \to \Cat$, there is a category $\int F$ that encapsulates all of the categories in the image of $F$, defined
as follows:
\[\begin{array}{rl}
\text{objects} & (d,x) \colon d\in \D, \; x\in F(d)\\
\text{morphisms} & (f\maps d\to d',a\maps F(f)(x)\to x')\\
\text{composition} & (f,a) \circ (f',a') = (f \circ f', a \circ F(f)(a')).
\end{array}\]
Moreover there is a functor $\overline{F} \maps \int F \to \D$ given as follows:
\[\begin{array}{rl}
\text{on objects} & \overline{F} \maps (d,x) \mapsto d \\
\text{on morphisms} & \overline{F} \maps (f,a) \mapsto f .\\
\end{array}\]
For more details see \cite{borceux,jacobs}.  We noted in $\S$4 that $\V\Law$ and $\Mod(\T,\C)$ are $\V$-categories when $\V$ is complete and cocomplete: this and further conditions imply we can use the \textit{enriched} Grothendieck construction \cite{beardsleywong}; but we will focus on the $\Set$-enriched case for simplicity. 

This idea allows us to bring together all of the different enrichments, theories, and models into one big category. For every enriching category $\V$, let $\V\Cat_{np}$ be the subcategory of $\V\Cat$ of $\V$-categories with $\NN$-powers and $\NN$-power preserving functors; then there is a functor $$\V\Mod\maps \V\Law^\op \times \V\Cat_{np} \to \Cat$$ which sends $(\T,\C)$ to $\V\Mod(\T,\C)$. The (bi)functoriality of $\V\Mod$ gives the contravariant change-of-theory and the covariant change-of-model above.

Using the Grothedieck construction, we obtain a category \textbf{$\int \V\Mod$}, with a morphism $$((f,g),\alpha)\maps ((\T,\C),\mu) \to ((\T',\C'),\mu')$$ being finite power-preserving $\V$-functors $f\maps\T\to \T'$, $g\maps\C\to \C'$, and $\V$-natural transformation $\alpha\maps\V\Mod(f,g)(\mu)\to \mu'$.

\begin{lemma}
	There is a functor $$\mathrm{thy}\maps \CCC \to \Cat$$ which assigns $\V$ to $\int \V\Mod$ and $(F\maps \V \to \W)$ to a functor $(F_*^*\maps \int \V\Mod \to \int \W\Mod)$.
\end{lemma}
\begin{proof}
	Given $F\maps\V\to \W$, base change $F_*\maps \V\Cat \to \W\Cat$ is a 2-functor, thereby inducing the functor $F_*^*\maps\V\Mod\to \W\Mod$ which sends a morphism $((f,g),\alpha)$ to $((F_*(f),F_*(g)),F_*(\alpha))$. Checking functoriality is left to the reader.
\end{proof}

Thus, we can use the Grothendieck construction once more to encapsulate even the enrichment:
\begin{theorem}
	There is a category $\mathrm{Thy} := \int \mathrm{thy}$ with a morphism $$(F,((f,g),\alpha))\maps (\V,((\T,\C),\mu)) \to (\W,((\T',\C'),\mu'))$$ being a cartesian functor $F$ and a morphism $(f,g,\alpha)\maps F_*^*(((\T,\C),\mu)) \to ((\T',\C'),\mu')$ in $\W\Mod$.
\end{theorem}

This category assimilates a whole lot of useful information. Most importantly, there are morphisms between objects of ``different kinds'', something we consider often but is normally not possible in category theory. For example, in $\mathrm{Thy}$ there is a morphism: 
\[ (\Set, ((u_{\Grp}, \mathrm{Disc}), \mathrm{exp}))\maps (\Set,((\T_{\mathrm{Grp}},\Set),(\mathbb{R},+,0))) \to (\Set,((\T_\Grp,\Top),(\mathbb{R},\times,1))) \]
There are many unexplored questions about the large, heterogeneous categories which arise from the Grothendieck construction, regarding what unusual structure may be gained, such as limits and colimits with objects of different types, or identifying ``processes'' in which the kinds of objects change in an essential way. This is just a remark; for our purposes we need only recognize that enriched Lawvere theories can be assimilated into one category, which provides a unified context for change-of-base, change-of-theory, and change-of-modelling.

\section{Applications}

In theoretical computer science literature, enriched algebraic theories have primarily been studied in the context of ``computational effects''. Mike Stay and Greg Meredith have recognized that Lawvere theories can actually be utilized for the design of \textit{programming languages} \cite{ladl}. This idea comes from an important but underappreciated subject in foundations --- combinatory logic.

\subsection{The $SKI$-combinator calculus}

The $\lambda$-calculus is an elegant formal language which is the foundation of functional computation, the model of intuitionistic logic, and the internal logic of cartesian closed categories: this is the Curry--Howard--Lambek correspondence \cite{baezstay}.

Terms are constructed recursively by \textit{variables}, \textit{application}, and \textit{abstraction}, and the basic rewrite is \textit{beta reduction}: 
\[ M,N := x \;\; | \;\; (M\; N) \;\; | \;\; \lambda x.M$$ $$(\lambda x.M\; N) \Rightarrow M[N/x] \]

Despite its apparent simplicity, there are complications regarding \textit{substitution}, or evaluation of functions. Consider the term $M = \lambda x.(\lambda y.(xy))$: if this is applied to the variable $y$, then $(M\; y) \Rightarrow \lambda y.(y\; y)$ --- but this is not intended, because the $y$ in $M$ is just a placeholder, it is ``bound'' by whatever will be plugged in, while the $y$ being substituted is ``free'', meaning it can refer to some other value or function in the program. Hence whenever a free variable is to be substituted for a bound variable, we need to rename the bound variable to prevent ``variable capture'' (e.g. $(M y) \Rightarrow \lambda z.(y\; z)$).

This problem was noticed early in the history of mathematical foundations, even before the $\lambda$-calculus, and so Moses Sch\"onfinkel invented \textbf{combinatory logic} \cite{combs}, a basic form of logic without the red tape of variable binding, hence without functions in the usual sense. The $SKI$-calculus is the ``variable-free'' representation of the $\lambda$-calculus; $\lambda$-terms are translated via ``abstraction elimination'' into strings of combinators and applications. This is an important method for programming languages to minimize the subtleties of variables. A great introduction into the world of strange and powerful combinators can be found in \cite{tmam}.

The key insight of Stay and Meredith \cite{roswelt} is that Lawvere theories are by definition free of variables, and it is precisely through abstraction elimination that a programming language can be made an algebraic object. When representing a computational calculus as an $\Gph$-theory, the general rewrite rules are simply edges in the hom-graphs $t^n \to t$, with the object $t$ serving in place of the variable. Below is the theory of the $SKI$-calculus:

$$\textbf{Th(\textit{SKI})}$$
\[\begin{array}{rcl}
\textbf{sort} & t &\\
\textbf{term constructors} & S\maps & 1 \to t\\
& K\maps & 1 \to t\\
& I\maps & 1 \to t\\
& (-\; -)\maps &  t^2 \to t\\
\textbf{structural congruence} & \text{n/a} &\\
\textbf{rewrites} & \sigma\maps & (((S\; -)\; =)\; \equiv) \Rightarrow ((-\; \equiv)\; (=\; \equiv))\\
& \kappa\maps & ((K\; -)\; =) \Rightarrow -\\
& \iota\maps & (I\; -) \Rightarrow -\\
\end{array}\]
These rewrites are implicitly universally quantified; i.e. they apply to arbitrary subterms $-, =, \equiv$ without any variable binding involved, by using the cartesian structure of the category. They are simply edges with vertices:
\[\begin{tikzcd}
(((S\; -)\; =)\; \equiv)\maps \arrow[Rightarrow,d,swap,"\sigma"] & t^3 \arrow[d,equal] \arrow[r,"l^{-1} \times t^3"] & 1\times t^3 \arrow[r,"S \times t^3"] & t^4 \arrow[Rightarrow,d,shorten >=0.2cm,shorten <=0.2cm] \arrow[r,"(-\;-)\times t^2"] & t^3 \arrow[r,"(-\;-) \times t"] & t^2 \arrow[r,"(-\;-)"] & t\arrow[d,equal]\\
((-\; \equiv)\; (=\; \equiv))\maps & t^3 \arrow[r,"t^2 \times \Delta"] & t^4 \arrow[r,"t \times \tau \times t"]& t^4 \arrow[rr,"(-\;-) \times (-\;-)"]&& t^2 \arrow[r,"(-\;-)"]& t\\
((K\; -)\; =)\maps \arrow[Rightarrow,d,swap,"\kappa"] & t^2 \arrow[d,equal] \arrow[r,"l^{-1} \times t^2"] & 1\times t^2 \arrow[r,"K \times t^2"] & t^3 \arrow[Rightarrow,d,shorten >=0.2cm,shorten <=0.2cm] \arrow[r,"(-\;-)\times t"] & t^2 \arrow[r,"(-\;-)"] & t \arrow[d,equal]\\
-\maps & t^2 \arrow[rr,"t \times !"] && t \times 1 \arrow[rr,"r"] && t\\
(I\; -)\maps \arrow[Rightarrow,d,swap,"\iota"] & t \arrow[d,equal] \arrow[r,"l^{-1}"] & 1\times t \arrow[r,"I \times t",""name=1] & t^2 \arrow[r,"(-\;-)"] & t \arrow[d,equal]\\
-\maps & t \arrow[rrr,"t",""name=2] \arrow[Rightarrow,from=1,to=2,shorten >=0.3cm,shorten <=0.3cm] &&& t
\end{tikzcd}\]

These abstract rules are evaluated on concrete terms by ``plugging in'' via precomposition:
\[\begin{tikzcd}
	((KS)I)\maps \arrow[Rightarrow,d,swap,"\kappa \circ (S\times I)"] & 1 \arrow[d,equal] \arrow[rr,"S\times I"] && t^2 \arrow[Rightarrow,d,shorten >=0.2cm,shorten <=0.2cm] \arrow[rr,"((K\; -)\; =)"] && t \arrow[d,equal]\\
	S\maps & 1 \arrow[rr,"S\times I"] && t^2 \arrow[rr,"-"] && t
\end{tikzcd}\]\\
(Morphisms $1\to t$ are the ``closed'' terms, meaning they have no free variables; in general morphisms $t^n\to t$ are terms with $n$ free variables, and the same reasoning applies.)\\

A model of this theory is a power-preserving $\Gph$-functor $\mu\maps \Th(SKI) \to \Gph$. This gives a graph $\mu(t)$ of all terms and rewrites in the $SKI$-calculus as follows:
\[\begin{tikzcd}
1 \cong \mu(1) \arrow[r,"\mu(S)"] & \mu(t) & \mu(t^2) \arrow[l,swap,"\mu(\left(-\;-\right))"] \cong \mu(t)^2
\end{tikzcd}\]
The images of the nullary operations $S,K,I$ are distinguished vertices of the graph $\mu(t)$, because $\mu$ preserves the terminal object which ``points out'' vertices. The image of the binary operation $(-\; -)$ gives for every pair of vertices $(u,v) \in \mu(t)^2$, through the isomorphism $\mu(t)^2 \cong \mu(t^2)$, a vertex $(u\; v)$ in $\mu(t)$ which is their application. In this way we get all possible terms (writing $\mu(S),\mu(K),\mu(I)$ as $S,K,I$ for simplicity): 
\[  ((((S\; (K\; (I\; I)))\; S) \dots \]

The rewrites are transferred by the enrichment of the functor: rather than functions between hom-sets, the morphism component of $\mu$ consists of graph homomorphisms between hom-graphs. So, $$\mu_{1,t}\maps \Th(SKI)(1,t)\to \Gph(1,\mu(t))$$ maps the ``syntactic'' graph of all closed terms and rewrites coherently into the ``semantic'' graph, meaning a rewrite in the theory $a\Rightarrow b$ is sent to a rewrite in the model $\mu(a) \Rightarrow \mu(b)$.

These rewrites in the image of $\mu$ are \textit{graph transformations}, which are just like natural transformations of functors, without the commuting diagram: given two graph homomorphisms $f,g\maps G\to H$, a graph transformation $\alpha\maps f \Rightarrow g$ is a function $G_0\to H_1$ which sends a vertex $v\in G$ to an edge $\alpha(v)$ with source $f(v)$ and target $g(v)$.

This is how the model realizes the $\Gph$-theory as an actual graph of terms and rewrites: in the same way that a transformation between two constant functors $a\Rightarrow b\maps 1\to \C$ is just a morphism $a(1)\to b(1)$ in $\C$, a rewrite of closed terms $a\Rightarrow b\maps 1\to \mu(t)$ corresponds to an edge in $\mu(t)$:
\[\begin{tikzcd}
	\mu((I\; S)) \;\; \bullet \arrow[r,"\mu(\iota)"] & \bullet \;\; \mu(S)
\end{tikzcd}\]

Finally, the fact that $\mu((-\;-))$ is not just a function but a graph homomorphism means that pairs of edges (rewrites) $(a\to b, c\to d)$ are sent to rewrites $(a\; b) \to (c\; d)$. This gives the full complexity of the theory: given a large term (program), there are many different ways it can be computed --- and some are better than others:
\[\begin{tikzcd}
	((K\; S)\; (((S\; K)\; I)\; (I\; K))) \arrow[r,"((K\; S)\; \sigma)"] \arrow[dddd,swap,"\kappa"] & ((K\; S)\; ((K\;(I\; K))\; (I\; (I\; K)))) \arrow[d,"(((K\; S)\; \iota)\; (I\; (I\; K)))"]\\
	& ((K\; S)\; ((K\; K)\; (I\; (I\; K)))) \arrow[d,"((K\; S)\; ((K\; K)\; (I\; \iota)))"]\\
	& ((K\; S)\; ((K\; K)\; (I\; K))) \arrow[d,"((K\; S)\; ((K\; K)\; \iota))"]\\
	& ((K\; S)\; ((K\; K)\; K)) \arrow[d,"((K\; S)\; \kappa)"]\\
	S & ((K\; S)\; K)\arrow[l,"\kappa"]
\end{tikzcd}\]

This process is intuitive, but how do we actually define the model, as a functor, to pick out a specific graph? There are many models of $\Th(SKI)$, but in particular we care about the canonical \textit{free} model, which means that $\mu(t)$ is simply the graph of all closed terms and rewrites in the $SKI$-calculus. This utilizes the enriched adjunction of $\S4$:
\[\begin{tikzcd}
\Gph \arrow[bend left=10,"f_\Gph"]{rr}
& \ld &
\arrow[bend left=10,"u_\Gph"]{ll} \Mod(\Th(SKI),\Gph)
\end{tikzcd}\]

Then the canonical model of closed terms and rewrites is simply the free model on the empty graph, $f_\Gph(\emptyset)$, i.e. the $\V$-functor $\T(1,-)\maps\T\to \V$. Hence for us, the syntax and semantics of the $SKI$ combinator calculus are unified in the model $$\mu_{SKI}^\Gph:= \Th(SKI)(1,-)\maps \Th(SKI) \to \Gph$$ Here we reap the benefits of the abstract construction: the graph $\mu_{SKI}^\Gph(t)$ is the \textit{transition system} which represents the \textbf{small-step operational semantics} of the $SKI$-calculus: $$(\mu(a) \to \mu(b) \in \mu_{SKI}^\Gph(t)) \iff (a \Rightarrow b \in \Th(SKI)(1,t))$$

Interestingly, in the free model on a nonempty graph, the vertices represent designated ``ground variables'', and edges represent rewrites of one variable into another. This is potentially useful for ``building in'' a language with other basic features not intrinsic to the theory.

\subsection{Change-of-base}
Now we can succinctly characterize the transformation from small-step to \textbf{big-step}, which is found throughout the operational semantics literature. The ``free category'' functor $\FC\maps \Gph \to \Cat$ gives for every graph $G$ the category $\FC(G)$ whose objects are the vertices of $G$, and whose morphisms are freely generated by the edges of $G$, i.e. sequences 
\[\begin{array}{rl}
\text{objects} & \text{vertices of } G\\
\text{morphisms} & \text{finite sequences of vertices and edges } (v_1,e_1,v_2,e_2,...,v_n)\\
\text{composition} & (v_1,e_1,v_2,e_2,...,v_n) \circ (v'_1,e'_1,v'_2,e'_2,...,v'_n) = (v_1,e_1,...,v_n=v'_1,e'_1,...,v'_n)\\
\end{array}\]

This functor is cartesian, because the definition of graphical product and categorical product are identical except for composition: vertices/objects are pairs of vertices/objects from each component, and same for edges/morphisms; hence the above operation fulfills the preservation isomorphism: $$\FC(G\times H) \cong \FC(G)\times \FC(H)$$ because they have the same objects, and a morphism of the former is a sequence of pairs, while that of the latter is the corresponding pair of sequences.

Thus $\FC$ is the change-of-semantics which induces the transitive closure of the rewrite relation, hence $$\mu_{SKI}^\Cat := \FC_*(\mu_{SKI}^\Gph)$$ is the category which represents the big-step operational semantics of the $SKI$-calculus. To correpond with the conventional meaning of big-step semantics, as noted in $\S1$, we can quotient by Curry's equations to identify $SKI$-terms which are extensionally equivalent \cite{barendregt}.

The same reasoning applies to the ``free poset'' functor $\FP\maps \Cat \to \Pos$; it is a change-of-semantics because the product of posets is defined in the same way. This induces the lesser-known \textbf{full-step semantics}, which collapses hom-sets to truth values, simply asserting the existence of a rewrite sequence between terms, without distinguishing between different paths. Since there was no real algebraic information in the free category, this is simply adding the property that all the distinct paths between two terms are equal, while retaining transitivity.

Finally, we can pass to the purely abstract realm where all computation is already complete.   One rarely speaks of the ``free set on a poset'', but there is a left adjoint $\FS\maps \Pos \to \Set$ of the functor $\UP \maps \Set \to \Pos$ sending any set to the discrete poset on that set.
The functor $\FP$ collapses every connected component of the poset to a point; equating every formal expression to its final value (this is cartesian because a pair of connected components corresponds to a connected component of pairs).

Assuming that the language is \textbf{terminating}, meaning every term has a finite sequence of possible rewrites, and \textbf{confluent}, meaning every pair of paths which branch from a term eventually rejoin, then this functor gives the denotational semantics of the language. (One more note here - the untyped $SKI$ calculus is actually not terminating, and so we need to consider the simply typed $SKI$-calculus \cite{barendregt}.)

Modulo a couple technicalities, from this simple sequence of functors, we can translate between the main kinds of semantics for the $SKI$-calculus. For example, we have the following computation:
\[\begin{tikzcd}
&	(((S\; K)\; (I\; K))\; S) \arrow[rd,"\sigma"] \arrow[ld,swap,"\iota"] \arrow[ddl,dotted,bend left=10,"\sigma\iota"] \arrow[ddl,dotted,bend right=10,"\iota\sigma"] \arrow[ddr,dotted,swap,bend left=10,"\kappa\sigma"] \arrow[ddr,dotted,bend right=10,swap,"\kappa\sigma\iota"] \arrow[ddr,dotted,swap,bend right=25,"\kappa\iota\sigma"] &\\
(((S\; K)\; K)\; S) \arrow[d,swap,"\sigma"] & & ((K\; S)\; ((I\; K)\; S)) \arrow[lld,swap,"\iota"] \arrow[d,"\kappa"]\\
((K\; S)\; (K\; S)) \arrow[rr,swap,"\kappa"] & & S
\end{tikzcd}\]

The solid arrows are the one-step rewrites of the initial $\Gph$-theory; applying $\FC_*$ gives the dotted composites, and $\FP_*$ asserts that all composites between any two objects are equal. Finally, $\FS_*$ collapses the whole diagram to $S$. This is a simple demonstration of the basic stages of computation: small-step, big-step, full-step, and denotational semantics.

Of course, most interesting languages are not always terminating, confluent, nor deterministic; the ``spectrum'' of semantics being presented here is simply an initial proof-of-concept. We expect that there are more interesting change-of-base functors which handle these subtleties --- they have likely been studied in other contexts.

\subsection{Change-of-theory: reduction contexts}
We can equip term calculi with \textit{reduction contexts}, which determine when rewrites are valid, thus giving the language a certain \textbf{evaluation strategy}. For example, the ``weak head normal form'' is given by only allowing rewrites on the left-hand side of the term.

We can do this for $\Th(SKI)$ by adding a reduction context marker as a unary operation, and a structural congruence rule which pushes the marker to the left-hand side of an application; lastly we modify the rewrite rules to be valid only when the marker is present:
$$\textbf{Th(\textit{SKI}+\textit{R})}$$
\[\begin{array}{rcl}
\textbf{sort} & t &\\
\textbf{term constructors} & S,K,I \maps &1 \to t\\
& R\maps & t \to t\\
& (-\; -)\maps & t^2 \to t\\\\
\textbf{structural congruence} & R(x\; y) = (Rx\; y) &\\
\textbf{rewrites} & \sigma_r\maps & (((RS\; -)\; =)\; \equiv) \Rightarrow ((R-\; \equiv)\; (=\; \equiv))\\
& \kappa_r\maps & ((RK\; -)\; =) \Rightarrow R-\\
& \iota_r\maps & (RI\; -) \Rightarrow R-\\
\end{array}\]

The $SKI$-calculus is thereby equipped with ``lazy evaluation'', an essential paradigm in modern programming. This represents a broad potential application of equipping theories with computational methods, such as evaluation strategies.

Moreover, these equipments can be added or removed as needed: using change-of-theory, we can utilize a ``free reduction'' $\Gph$-functor $f_R\maps\Th(SKI)\to \Th(SKI+R)$:
\[\begin{array}{rrcl}
\text{objects} & t^n & \mapsto & t^n\\
\text{hom-vertices} & S,K,I & \mapsto & S,K,I\\
& (-\; -) & \mapsto & R(-\; -)\\
\text{hom-edges} & \sigma, \kappa, \iota & \mapsto & \sigma_r, \kappa_r, \iota_r\\
\end{array}\]
This essentially interprets ordinary $SKI$ as having every subterm be a reduction context. This is a $\Gph$-functor because its hom component consists of graph-homomorphisms: $$f_{n,m}\maps \Th(SKI)(t^n,t^m) \to \Th(SKI+R)(t^n,t^m)$$ which simply send each application to its postcomposition with $R$, and each rewrite to its ``marked'' correspondent; and this is all coherent: for example, even though $(((S\; x)\; y)\; z) \mapsto R(R(R(S\; x)\; y)\; z)$, the extra markers are ignored by $\sigma_r$, because they are now just a part of the lefthand terms.

So, by precomposition this induces the change of theory on categories of models: $$f_R^*\maps \Mod(\Th(SKI+R),\C) \to \Mod(\Th(SKI),\C)$$ for all semantic categories $\C$, which forgets the reduction contexts.

Similarly, there is a $\Gph$-functor $u_R\maps \Th(SKI+R)\to \Th(SKI)$ which forgets reduction contexts, by sending $\sigma_r,\kappa_r,\iota_r \mapsto\sigma, \kappa,\iota$ and $R \mapsto id_t$; this latter is the only way that the marked reductions can be mapped coherently to the unmarked. However, this means that $u_R^*$ does not give the desired change-of-theory of ``freely adjoining contexts'', because collapsing $R$ to the identity eliminates the significance of the marker.

This illustrates a key aspect of categorical universal algebra: because change-of-theory is given by precomposition and is thus contravariant, \textit{properties} (equations) and \textit{structure} (operations) can only be removed.

This is a necessary limitation, at least in the present setup, but there are ways of working around it: of course, these abstract theories are not floating in isolation but are implemented in code. One can simply use a ``maximal theory'' with all pertinent structure, then selectively forget as needed.

\subsection{Multisorted: the $\rho$-calculus}

Many algebraic theories involve multiple sorts in an essential way. In concurrency theory, \textit{process calculi} exhibit an ontology which is fundamentally distinct from that of sequential computing --- rather than simply expressing a series of terms and rewrites, these calculi represent dynamical systems of communicating processes.

The $\pi$-calculus, designed by Milner \cite{milner}, consists of \textbf{names} and \textbf{processes}, or \textit{channels} and \textit{agents} which communicate on those channels. Far more than a sequence of instructions on a single machine, computation develops through the interaction of independent participants in a network.

This powerful idea of modern computer science is being utilized by Greg Meredith and Mike Stay to design a deeply cooperative distributive computing system, called RChain. The ``R'' stands for ``reflective higher-order $\pi$-calculus'', or \textbf{$\rho$-calculus}. It is like Milner's original language, with one crucial difference: ``reflection'' is a formal system's ability to turn code into data and vice versa. This is a powerful idea which replaces opaque, atomic variables with transparent, anatomical names, or ``quoted processes'' \cite{refl}.

Utilizing both reflection and combinators in a theory requires special type discipline; there is a designated auxiliary sort $T$ for combinatory terms which are analogous to ``machine code'', as contrasted with the sorts $N$ and $P$ which are to be thought of as the actual language: see \cite{roswelt} $\S$7.3 for the details of the translation. The presentation below is only a fragment; it has yet to be determined how to best represent the full algebraic theory of the $\rho$-calculus; we expect that a true mathematical characterization of reflection will call for original and enlightening ideas.\\

\[\textbf{\text{Th(RHO)}}\]
\[\begin{array}{lrllrll}
	\textbf{Sorts} & N && \text{names} & T && \text{terms}\\
	& P && \text{processes} &&&\\\\
	\textbf{Operations} & 0\maps & 1 \to P & \text{null process} & S\maps & 1\to T & \text{combinator}\\
	& \&\maps & P \to N & \text{code to data} & K\maps & 1\to T & \text{combinator}\\
	& *\maps & N \to P & \text{data to code} & (-\;-)\maps & T^2 \to T & \text{application}\\
	& !\maps & N\times P \to P & \text{send} &&&\\
	& ?\maps & N^2\times P \to P & \text{receive} &&&\\
		& -\; |\; - \maps & P^2 \to P & \text{parallel} &&&\\\\
	\textbf{Equations} && (P,\; |,\; 0) & \text{commutative} &&&\\
	&&& \text{monoid} &&&\\\\
	\textbf{Rewrites} & \gamma\maps & x?(y).P\; |\; x!(z)\; |\; Q \Rightarrow & P[z/y]\; |\; Q & \sigma\maps & (((S\; -)\; =)\; \equiv) \Rightarrow & ((-\; \equiv)\;(=\; \equiv))\\
	& \epsilon\maps & *(\&(P)) \Rightarrow & P & \kappa\maps & ((K\; -)\; =) \Rightarrow & -\\
\end{array}\]

\section{Conclusion}

We have established the basics of how enriched Lawvere theories provide a framework for unifying the syntax and semantics, the structure and behavior of formal languages. Enriching theories in category-like structures reifies operational semantics by incorporating rewrites between terms; and cartesian functors between enriching categories induce change-of-semantics functors between categories of models---this simplified condition is obtained by using only finite cardinal arities.

This base-change, along with change-of-theory and change-of-modelling, can be assimilated into one category using an iterated Grothendieck construction $\mathrm{Thy}$, which consists of all enriched Lawvere theories. Finally, enriched theories can be used not only for computational effects but the actual design of concrete programming languages, through the use of combinators.

%For future work, we will consider the enrichment of simplicial sets $$\V = \mathrm{sSet} := [\Delta^\op,\Set]$$ and explore the change-of-base induced by nerve and realization. We expect there to be great utility and insight in the model-categorical, toposic, and cohomological analysis of simplicial theories.

%We will also build upon the current ideas, with development of more interesting and useful implementations of change-of-base and change-of-theory, illustrated with other languages and combinators. This approach will be connected with the co-algebra approach to operational semantics, and pertinent concepts such as bisimulation will be comprehended from this perspective.\\

%Additionally, we will begin research on \textit{distributive laws} for enriched Lawvere theories, as developed with $\Set$-enrichment by Eugenia Cheng \cite{ltdistlaw}. We aim to determine necessary and sufficient conditions for the existence of a distributive law between any two enriched Lawvere theories, as well as its construction; this will be used in the ``logic as a distributive law'' algorithm, developed by Greg Meredith and Mike Stay to generate sound type systems and query languages for distributed computing systems. We thank them again for providing us the opportunity and support to develop this research.

\begin{thebibliography}{100}

\bibitem{adamekrosicky} J.\ Ad\'{a}mek and J.\ Rosick\'{y}, \textsl{Locally Presentable and Accessible Categories}, Cambridge U.\ Press, Cambridge, 1994.

\bibitem{baezstay} J.\ Baez and M.\ Stay, Physics, topology, logic and computation: a Rosetta Stone, in \textsl{New Structures for Physics}, ed.\ B.\ Coecke, Springer, Berlin, 2011, pp.\ 95--172.  Available as \href{https://arxiv.org/abs/0903.0340}{arXiv:0903.0340}.

\bibitem{barendregt} H.P. Barendregt, The Lambda Calculus, its syntax and semantics, in \textsl{Studies in Logic and The Foundations of Mathematics}, Elsevier, London, 1984.
	
\bibitem{barrwells} M.\ Barr and C.\ Wells, \textsl{Toposes, Triples and Theories}, reprinted in \textsl{Repr.\ Theory Appl.\ Categ.} \textbf{12} (2005).   Available at \href{http://www.tac.mta.ca/tac/reprints/articles/12/tr12abs.html}{http://www.tac.mta.ca/tac/reprints/articles/12/tr12abs.html}.

\bibitem{beardsleywong} J.\ Beardsley and L.\ Z.\ Wong, The enriched Grothendieck construction.  Available as \href{https://arxiv.org/abs/1804.03829}{arXiv:1804.03829}.
	
\bibitem{bergermelliesweber} C.\ Berger, P.-A.\ Melli\`es and M.\ Weber, Monads with arities and their associated theories, \textsl{J.\ Pure Appl.\ Algebra}, \textbf{216} (2012), 2029--2048.  Available as \href{https://arxiv.org/abs/1101.3064}{arXiv:1101.3064}.

\bibitem{bkp} R.\ Blackwell, G.\ M.\ Kelly and A.\ J.\ Power, Two-dimensional monad theory, 
\textsl{J.\ Pure Appl.\ Algebra} \textbf{59} (1989), 1--41. 
 
\bibitem{borceux} F.\ Borceux, \textsl{Handbook of Categorical Algebra}, vol.\ 2, Cambridge U.\ Press, Cambridge, 1994.

%\bibitem{ltdistlaw} E.\ Cheng, Distributive laws for Lawvere theories, \href{https://arxiv.org/abs/1112.3076}{arXiv:1112.3076}.

\bibitem{crole} R.\ Crole, \textsl{Categories for Types}, Cambridge U.\ Press, Cambridge, 1993.

\bibitem{hylandpower} M.\ Hyland and J.\ Power, The category theoretic understanding of 
universal algebra: Lawvere theories and monads, in \textsl{Electron.\ Notes Theor.\ Comput.\ 
Sci.} \textbf{172} (2007), 437--458.

\bibitem{jacobs} B.\ Jacobs, \textsl{Categorical Logic and Type Theory}, Elsevier, Amderstam, 1999.
	
\bibitem{kelly} G.\ M.\ Kelly, \textsl{Basic Concepts of Enriched Category Theory}, reprinted in
\textsl{Repr.\ Theory Appl.\ Categ.} \textbf{10} (2005), 1--136.  Available at \href{http://www.tac.mta.ca/tac/reprints/articles/10/tr10abs.html}{http://www.tac.mta.ca/tac/reprints/articles/10/tr10abs.html}.

\bibitem{powsketch} Y.\ Kinoshita, J.\ Power and M.\ Takeyama, Sketches,
\textsl{J.\ Pure Appl.\ Algebra} \textbf{143} (1999), 275--291.

\bibitem{pseudo} B.\ Day and R.\ Street, Monoidal categories and Hopf algebroids,
\textsl{Adv.\ Math.} \textbf{127} (1997), 99--157.

\bibitem{lawvere} F.\ W.\ Lawvere, Functorial semantics of algebraic theories, reprinted in
\textsl{Repr.\ Theory Appl.\ Categ.} \textbf{5} (2004), 1--121.  Available at \href{http://tac.mta.ca/tac/reprints/articles/5/tr5abs.html}{http://tac.mta.ca/tac/reprints/articles/5/tr5abs.html}.

\bibitem{linton} F.\ E.\ J.\ Linton, Some aspects of equational theories, in 
\textsl{Proceedings of the Conference on Categorical Algebra}, eds.\ S.\ Eilenberg et al.,
Springer, Berlin, 1965.

\bibitem{lucyshyn-wright} R.\ B.\ B.\ Lucyshyn-Wright, Enriched algebraic theories and monads for a system of arities, \textsl{Theory Appl. Categ.} \textbf{31} (2016), 101--137.  Available at \href{http://www.tac.mta.ca/tac/volumes/31/5/31-05abs.html}{http://www.tac.mta.ca/tac/volumes/31/5/31-05abs.html}.
	
\bibitem{ghani} C.\ L\"{u}th and N.\ Ghani, Monads and modular term rewriting,
\textsl{Category Theory and Computer Science ({S}anta {M}argherita Ligure, 1997)}, Springer, Berlin, 1997, pp.\ 69--86.  Available at \href{http://www.informatik.uni-bremen.de/~cxl/papers/ctcs97l.pdf}{http://www.informatik.uni-bremen.de/\~cxl/papers/ctcs97l.pdf}.

\bibitem{maclane} S.\ Mac Lane, \textsl{Categories for the Working Mathematician}, Springer, Berlin, 1998.  

\bibitem{refl} L.\ G.\ Meredith and M.\ Radestock, A reflective higher-order calculus,
\textsl{Electronic Notes in Theoretical Computer Science} \textbf{141} (2005), 49--67.

\bibitem{milewski} B.\ Milewski, \textsl{Category Theory for Programmers}, Chap.\ 14: Lawvere theories, 2017.   Available at \href{https://bartoszmilewskiski.com/2017/08/26/lawvere-theories/}{https://bartoszmilewski.com/2017/08/26/lawvere-theories/}.

\bibitem{milner} R.\ Milner, The polyadic {$\pi$}-calculus: a tutorial, in \textsl{Logic and Algebra of Specification}, Springer, Berlin, 1993, 203--246.

\bibitem{np} K.\ Nishizawa and J.\ Power, Lawvere theories enriched over a general base, \textsl{J.\ Pure Appl.\ Algebra}  \textbf{213} (2009), 377--386.

\bibitem{sos} G.\ D.\ Plotkin, A structural approach to operational semantics, \textsl{J.\ Log.\ Algebr\ Program.} \textbf{60/61} (2004) 17--139.  Available at \href{http://homepages.inf.ed.ac.uk/gdp/publications/sos_jlap.pdf}{http://homepages.inf.ed.ac.uk/gdp/publications/sos\_jlap.pdf}.

\bibitem{power} J.\ Power, Enriched Lawvere theories, \textsl{Theory Appl.\ Categ.} \textbf{6}(1999), 83--93.

\bibitem{combs} M.\ Sch\"{o}nfinkel, \"Uber die Bausteine der mathematischen Logik, 
 \textsl{Mathematische Annalen} \textbf{92} (1924), 305--316.  Available at \href{http://www.digizeitschriften.de/dms/img/?PID=GDZPPN002270110}{http://www.digizeitschriften.de/dms/img/?PID=GDZPPN002270110}.
 
\bibitem{seely} R.\ A.\ G.\ Seely, Modelling computations: a 2-categorical framework, in
\textsl{Proceedings of the Second Annual IEEE Symposium on Logic in Computer Science (LICS 1987)}, IEEE Computer Society Press, Ithaca, New York, pp.\ 22--25.
 
 \bibitem{lam} P.\ Selinger, Lecture notes on the lambda calculus.  Available as 
 \href{https://arxiv.org/abs/0804.3434}{arXiv:0804.3434}.

\bibitem{tmam} R.\ Smullyan, \textsl{To Mock a Mockingbird: and Other Logic Puzzles Including an Amazing Adventure in Combinatory Logic}, Oxford U.\ Press, Oxford, 2000.
	
\bibitem{roswelt} M.\ Stay and L.\ G.\ Meredith, Representing operational semantics 
with enriched Lawvere theories.  Available as
\href{https://arxiv.org/abs/1704.03080}{arXiv:1704.03080}.

\bibitem{ladl} M.\ Stay and L.\ G.\ Meredith, Logic as a distributive law.  Available as \href{https://arxiv.org/abs/1610.02247}{arXiv:1610.02247}.

\end{thebibliography}

\end{document}